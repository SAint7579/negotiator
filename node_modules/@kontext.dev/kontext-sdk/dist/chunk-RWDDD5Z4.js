import {a}from'./chunk-OI6YVS4E.js';import pe,{createContext,useState,useContext,useRef,useEffect,useCallback,useId}from'react';import {QueryClient,QueryClientProvider}from'@tanstack/react-query';import {createTRPCReact}from'@trpc/react-query';import {httpBatchLink}from'@trpc/client';import Ke from'superjson';import {jsx,jsxs,Fragment}from'react/jsx-runtime';import {useFloating,useClick,useRole,useInteractions}from'@floating-ui/react';var Z=createTRPCReact(),ce=createContext(void 0),Le=1440*60*1e3;function ie({apiKey:e,apiUrl:d,children:m}){let[g,u]=useState(false),[o,a$1]=useState(null),[b,x]=useState(true),[h,f]=useState(null),[k,v]=useState(null),[n,M]=useState(null),[l,z]=useState(false),w=pe.useMemo(()=>e?new a({apiKey:e,apiUrl:d||"https://api.kontext.dev"}):null,[e,d]),s=n?Date.now()-n.getTime()>Le:true,P=useCallback(async()=>{if(!(!o||!e)){z(true),f(null);try{if(!w)throw new Error("Persona client not initialized");let c=await w.getContext({userId:o,task:"chat",maxTokens:500});v(c.systemPrompt),M(new Date);}catch(c){console.debug("[Kontext SDK] Failed to fetch profile:",c);}finally{z(false);}}},[o,d,e,w]),i=useCallback(async()=>{if(!e){x(false);return}try{let S=new URLSearchParams(window.location.search).get("user_id");if(S)a$1(S),u(!0),window.history.replaceState({},document.title,window.location.pathname),localStorage.setItem("persona_user_id",S);else {let T=localStorage.getItem("persona_user_id");T&&(a$1(T),u(!0));}}catch(c){console.debug("[Kontext SDK] Failed to check connection:",c);}finally{x(false);}},[e,P]);useEffect(()=>{i();},[]),useEffect(()=>{o&&g&&!k&&P();},[o,g,k,P]);let p=async()=>{if(!d||!e){let c="API URL and API key required for Gmail connection";throw f(c),new Error(c)}try{let c=new URL(window.location.href),S=`${c.origin}${c.pathname}`;if(!S.startsWith(window.location.origin))throw new Error("Invalid redirect URI - must be from the same origin");let T=await fetch(`${d}/oauth/gmail?redirect_uri=${encodeURIComponent(S)}`,{method:"GET",headers:{"x-api-key":e}}).catch(E=>{throw console.debug("[Kontext SDK] Network error during OAuth:",E),new Error("Network error. Please check your connection and try again.")});if(T.ok){let E=await T.json().catch(()=>null);if(E?.authUrl)window.location.href=E.authUrl;else throw new Error("No authorization URL received from server")}else {let E=await T.json().catch(()=>({error:{message:"Failed to initiate OAuth"}}));throw new Error(E.error?.message||"Failed to initiate OAuth")}}catch(c){let S=c instanceof Error?c.message:"Failed to initiate Gmail connection";throw console.debug("[Kontext SDK] Failed to initiate Gmail connection:",c),f(S),c}},K=async()=>{if(!o||!w){let c="Must be connected to disconnect";throw f(c),new Error(c)}try{await w.disconnect(o);}catch(c){console.debug("[Kontext SDK] Failed to disconnect:",c);}finally{a$1(null),u(false),v(null),M(null),f(null),localStorage.removeItem("persona_user_id");}},L=useCallback(async()=>{if(!g||!o)throw new Error("User must be connected to refresh profile");await P();},[g,o,P]),U={apiKey:e,isConnected:g,userId:o,isLoading:b,error:h,connectGmail:p,disconnect:K,systemPrompt:k,profileLastUpdated:n,isProfileStale:s,isRefreshingProfile:l,refreshProfile:L,trpc:Z};return jsx(ce.Provider,{value:U,children:m})}function nt({apiKey:e,apiUrl:d="https://api.kontext.dev",children:m}){let[g]=useState(()=>new QueryClient({defaultOptions:{queries:{staleTime:6e5,gcTime:18e5,retry:(o,a)=>{let b=a;return b?.status&&b.status>=400&&b.status<500?false:o<3},refetchOnWindowFocus:false,refetchOnReconnect:true},mutations:{retry:1}}})),[u]=useState(()=>e?Z.createClient({transformer:Ke,links:[httpBatchLink({url:`${d}/trpc`,maxItems:10,maxURLLength:2083,async headers(){return {"x-api-key":e}},fetch(o,a){return fetch(o,{...a,keepalive:true})}})]}):null);return u?jsx(Z.Provider,{client:u,queryClient:g,children:jsx(QueryClientProvider,{client:g,children:jsx(ie,{apiKey:e,apiUrl:d,children:m})})}):jsx(QueryClientProvider,{client:g,children:jsx(ie,{apiKey:e,apiUrl:d,children:m})})}function O(){let e=useContext(ce);if(!e)throw new Error("useKontext must be used within KontextProvider");return e}function le(){let e=O();return {systemPrompt:e.systemPrompt,lastUpdated:e.profileLastUpdated,isStale:e.isProfileStale,isRefreshing:e.isRefreshingProfile,refresh:e.refreshProfile}}function A(e={}){let{initialTheme:d="light",onThemeChange:m}=e,[g,u]=useState(d),o=useRef(null),a=useRef(null),b=useRef(null),x=useRef(m);return x.current=m,useEffect(()=>{let h=()=>{let n=document.documentElement.classList.contains("dark")||document.body.classList.contains("dark")||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";u(n),x.current?.(n);};b.current=h,h();let f=new MutationObserver(h);o.current=f,f.observe(document.documentElement,{attributes:true,attributeFilter:["class"]});let k=window.matchMedia("(prefers-color-scheme: dark)");return a.current=k,k.addEventListener("change",h),()=>{o.current&&(o.current.disconnect(),o.current=null),a.current&&b.current&&(a.current.removeEventListener("change",b.current),a.current=null),b.current=null;}},[]),g}var W={light:{background:"#ffffff",foreground:"#0a0a0a",card:"#ffffff",cardForeground:"#0a0a0a",popover:"#ffffff",popoverForeground:"#0a0a0a",primary:"#0066cc",primaryForeground:"#ffffff",secondary:"#fafafa",secondaryForeground:"#0a0a0a",muted:"#f5f5f5",mutedForeground:"#666666",accent:"#f5f5f5",accentForeground:"#0a0a0a",destructive:"#dc2626",destructiveForeground:"#ffffff",border:"#f0f0f0",input:"#f0f0f0",ring:"#0066cc",success:"#22c55e",successForeground:"#ffffff",warning:"#f59e0b",zinc:"#71717a",forestGreen:"#16a34a"},dark:{background:"#0a0a0a",foreground:"#f5f5f5",card:"#0a0a0a",cardForeground:"#f5f5f5",popover:"#0a0a0a",popoverForeground:"#f5f5f5",primary:"#4d94ff",primaryForeground:"#0a0a0a",secondary:"#1a1a1a",secondaryForeground:"#f5f5f5",muted:"#1a1a1a",mutedForeground:"#999999",accent:"#1a1a1a",accentForeground:"#f5f5f5",destructive:"#ef4444",destructiveForeground:"#f5f5f5",border:"#262626",input:"#262626",ring:"#4d94ff",success:"#22c55e",successForeground:"#0a0a0a",warning:"#f59e0b",zinc:"#a1a1aa",forestGreen:"#22c55e"}},t={fontSans:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif",fontMono:"ui-monospace, 'SF Mono', Monaco, 'Cascadia Mono', 'Segoe UI Mono', 'Roboto Mono', monospace",fontSize:{xs:"0.75rem",sm:"0.875rem",base:"1rem",lg:"1.125rem",xl:"1.25rem"},fontWeight:{normal:400,medium:500,semibold:600,bold:700},lineHeight:{tight:"1.25",normal:"1.5",relaxed:"1.75"}},r={0:"0",1:"0.25rem",2:"0.5rem",3:"0.75rem",4:"1rem",5:"1.25rem",6:"1.5rem",8:"2rem"},R={none:"0",sm:"0.125rem",base:"0.375rem",md:"0.5rem",lg:"0.75rem",xl:"1rem",squircle:"1.25rem",full:"9999px"},$={fast:"all 150ms ease",base:"all 200ms ease",slow:"all 300ms ease"},N={low:"0 2px 8px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04)",medium:"0 4px 16px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0, 0, 0, 0.06)",high:"0 8px 32px rgba(0, 0, 0, 0.16), 0 4px 8px rgba(0, 0, 0, 0.08)",lowDark:"0 2px 8px rgba(0, 0, 0, 0.32), 0 1px 2px rgba(0, 0, 0, 0.24)",mediumDark:"0 4px 16px rgba(0, 0, 0, 0.48), 0 2px 4px rgba(0, 0, 0, 0.32)",highDark:"0 8px 32px rgba(0, 0, 0, 0.64), 0 4px 8px rgba(0, 0, 0, 0.48)"},Oe=()=>{if(typeof window>"u")return "light";let e=document.documentElement.classList.contains("dark")||document.body.classList.contains("dark");return !e&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e?"dark":"light"},ct=()=>{let e=Oe();return W[e]},lt={default:e=>({backgroundColor:e.primary,color:e.primaryForeground,border:"none","&:hover":{backgroundColor:e.primary,opacity:.9}}),secondary:e=>({backgroundColor:e.secondary,color:e.secondaryForeground,border:"none","&:hover":{backgroundColor:e.secondary,opacity:.8}}),outline:e=>({backgroundColor:e.background,color:e.foreground,border:`1px solid ${e.border}`,"&:hover":{backgroundColor:e.accent}}),ghost:e=>({backgroundColor:"transparent",color:e.foreground,border:"none","&:hover":{backgroundColor:e.accent}}),destructive:e=>({backgroundColor:e.destructive,color:e.destructiveForeground,border:"none","&:hover":{backgroundColor:e.destructive,opacity:.9}}),success:e=>({backgroundColor:e.success,color:e.successForeground,border:"none","&:hover":{backgroundColor:e.success,opacity:.9}})},q={sm:{height:"2rem",padding:"0 0.75rem",fontSize:t.fontSize.sm,gap:"0.375rem"},default:{height:"2.25rem",padding:"0 1rem",fontSize:t.fontSize.sm,gap:"0.5rem"},lg:{height:"2.5rem",padding:"0 1.5rem",fontSize:t.fontSize.base,gap:"0.5rem"}},dt={fontFamily:t.fontSans,fontWeight:t.fontWeight.medium,borderRadius:R.base,transition:$.fast,cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",outline:"none",position:"relative","&:disabled":{opacity:.5,cursor:"not-allowed"},"&:focus-visible":{outline:"3px solid",outlineOffset:"2px"}},ut=e=>({backgroundColor:e.card,color:e.cardForeground,border:`1px solid ${e.border}`,borderRadius:R.lg,padding:r[6],boxShadow:"none"}),ft=(e,d,m)=>({base:e,hover:d||e,active:m||d||e});function We({className:e="",children:d="Connect Gmail",variant:m="default",size:g="default",fullWidth:u=false,onError:o}){let{connectGmail:a,isConnected:b,isLoading:x}=O(),h=A(),[f,k]=useState(false),[v,n]=useState(false),[M,l]=useState(null),[z,w]=useState(false),s=W[h];if(b)return null;let P=async()=>{n(true),l(null),w(false);try{await a();}catch(S){console.debug("[KontextConnectButton] Connection error caught:",S);let T="Unable to connect. Please try again.";l(T),w(true),o&&o(T),setTimeout(()=>w(false),5e3);}finally{n(false);}},p=(()=>{let S={default:{backgroundColor:s.primary,color:s.primaryForeground,border:"none"},secondary:{backgroundColor:s.secondary,color:s.secondaryForeground,border:"none"},outline:{backgroundColor:"transparent",color:s.foreground,border:`1px solid ${s.border}`},ghost:{backgroundColor:"transparent",color:s.foreground,border:"none"},success:{backgroundColor:s.success,color:s.successForeground,border:"none"}},T={default:{backgroundColor:s.primary,opacity:.9},secondary:{backgroundColor:s.secondary,opacity:.8},outline:{backgroundColor:s.accent},ghost:{backgroundColor:s.accent},success:{backgroundColor:s.success,opacity:.9}};return {base:S[m],hover:T[m]}})(),K=q[g],L={fontFamily:t.fontSans,fontWeight:t.fontWeight.medium,borderRadius:R.lg,transition:$.fast,cursor:v||x?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",outline:"none",position:"relative",width:u?"100%":"auto",...K,...p.base,border:"none",boxShadow:`
      0 0 0 1px ${s.forestGreen},
      0 0 0 2px ${s.zinc},
      ${h==="dark"?N.lowDark:N.low}
    `,...f&&!v&&!x?p.hover:{},opacity:v||x?.5:f&&"opacity"in p.hover?p.hover.opacity:1},U=()=>jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",style:{animation:"spin 1s linear infinite"},children:jsxs("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"32",strokeDashoffset:"32",children:[jsx("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 32;16 16;0 32;0 32",repeatCount:"indefinite"}),jsx("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-16;-32;-32",repeatCount:"indefinite"})]})}),c={position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:r[2],backgroundColor:s.destructive,color:s.destructiveForeground,padding:`${r[1]} ${r[2]}`,borderRadius:R.base,fontSize:t.fontSize.xs,fontFamily:t.fontSans,whiteSpace:"nowrap",opacity:z?1:0,pointerEvents:"none",transition:$.fast,zIndex:10};return jsxs(Fragment,{children:[jsxs("div",{style:{position:"relative",display:"inline-block",width:u?"100%":"auto"},children:[z&&M&&jsx("div",{style:c,children:M}),jsx("button",{onClick:P,disabled:v||x,className:e,style:L,onMouseEnter:()=>k(true),onMouseLeave:()=>k(false),onFocus:S=>{S.currentTarget.style.boxShadow=`
              0 0 0 1px ${s.forestGreen},
              0 0 0 2px ${s.zinc},
              0 0 0 5px ${s.ring},
              ${h==="dark"?N.lowDark:N.low}
            `;},onBlur:S=>{S.currentTarget.style.boxShadow=`
              0 0 0 1px ${s.forestGreen},
              0 0 0 2px ${s.zinc},
              ${h==="dark"?N.lowDark:N.low}
            `;},children:v||x?jsxs("span",{style:{display:"flex",alignItems:"center",gap:r[2]},children:[jsx(U,{}),"Connecting..."]}):d})]}),jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function Ge({className:e="",connectedText:d="Personalized responses enabled",disconnectedText:m="Connect Gmail for personalized responses",showDisconnect:g=false,disconnectClassName:u="",variant:o="inline"}){let{isConnected:a,isLoading:b,disconnect:x}=O(),[h,f]=useState("light"),[k,v]=useState(false);useEffect(()=>{let p=()=>{let U=document.documentElement.classList.contains("dark")||document.body.classList.contains("dark")||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;f(U?"dark":"light");};p();let K=new MutationObserver(p);K.observe(document.documentElement,{attributes:true,attributeFilter:["class"]});let L=window.matchMedia("(prefers-color-scheme: dark)");return L.addEventListener("change",p),()=>{K.disconnect(),L.removeEventListener("change",p);}},[]);let n=W[h],l=(()=>{let p={fontFamily:t.fontSans,fontSize:t.fontSize.sm,display:"flex",alignItems:"center",gap:r[2]};switch(o){case "card":return {...p,backgroundColor:n.card,color:n.cardForeground,border:`1px solid ${n.border}`,borderRadius:R.lg,padding:r[4],boxShadow:"none"};case "badge":return {...p,backgroundColor:a?n.success:n.muted,color:a?n.successForeground:n.mutedForeground,borderRadius:R.full,padding:`${r[1]} ${r[3]}`,fontSize:t.fontSize.xs,fontWeight:t.fontWeight.medium,display:"inline-flex"};case "inline":default:return {...p,color:n.foreground}}})(),z={color:n.mutedForeground,fontFamily:t.fontSans,fontSize:t.fontSize.sm,display:"flex",alignItems:"center",gap:r[2]},w={color:n.success,fontWeight:t.fontWeight.semibold,fontSize:o==="badge"?t.fontSize.xs:t.fontSize.sm},s={color:a?o==="badge"?n.successForeground:n.success:n.mutedForeground,fontWeight:o==="badge"?t.fontWeight.medium:t.fontWeight.normal},P={marginLeft:r[2],backgroundColor:k?n.accent:"transparent",color:n.destructive,fontWeight:t.fontWeight.medium,padding:`${r[1]} ${r[2]}`,borderRadius:R.base,border:`1px solid ${n.destructive}`,cursor:"pointer",transition:$.fast,fontFamily:t.fontSans,fontSize:t.fontSize.xs,outline:"none"},i=()=>jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",style:{animation:"spin 1s linear infinite",color:n.mutedForeground},children:jsxs("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"32",strokeDashoffset:"32",children:[jsx("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 32;16 16;0 32;0 32",repeatCount:"indefinite"}),jsx("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-16;-32;-32",repeatCount:"indefinite"})]})});return b?jsxs(Fragment,{children:[jsxs("div",{className:e,style:{...l,...z},children:[jsx(i,{}),jsx("span",{children:"Loading..."})]}),jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}):a?jsxs("div",{className:e,style:l,children:[jsx("span",{style:w,children:"\u2713"}),jsx("span",{style:s,children:d}),g&&jsx("button",{onClick:x,className:u,style:P,onMouseEnter:()=>v(true),onMouseLeave:()=>v(false),onFocus:p=>{p.currentTarget.style.outline=`2px solid ${n.ring}`,p.currentTarget.style.outlineOffset="2px";},onBlur:p=>{p.currentTarget.style.outline="none";},children:"Disconnect"})]}):jsx("div",{className:e,style:l,children:jsx("span",{style:s,children:m})})}function ee(e={}){let{initialOpen:d=false,onOpenChange:m,onConnectingChange:g}=e,[u,o]=useState(d),[a,b]=useState(false),x=useRef(m),h=useRef(g);x.current=m,h.current=g;let f=useCallback(l=>{o(l),x.current?.(l);},[]),k=useCallback(l=>{b(l),h.current?.(l);},[]),v=useCallback(()=>f(true),[f]),n=useCallback(()=>f(false),[f]),M=useCallback(()=>f(!u),[u,f]);return {isOpen:u,isConnecting:a,open:v,close:n,toggle:M,setConnecting:k}}function je({trigger:e,className:d="",id:m}){let g=useId(),u=m||g,{isOpen:o,isConnecting:a,open:b,close:x,setConnecting:h}=ee(),f=A(),{isConnected:k,connectGmail:v,disconnect:n,isLoading:M}=O(),l=le(),[z,w]=pe.useState(null),[s,P]=pe.useState(false),i=W[f],p=async()=>{h(true),w(null),P(false);try{await v();}catch(y){console.debug("[KontextModal] Connection error caught:",y),w("Unable to connect at this time. Please try again later."),P(true),setTimeout(()=>P(false),5e3);}finally{h(false);}},K=async()=>{try{await n();}catch(y){console.debug("[KontextModal] Disconnect error caught:",y);}},L=y=>{let oe=Math.floor((Date.now()-y.getTime())/1e3);if(oe<60)return "just now";let H=Math.floor(oe/60);if(H<60)return `${H} minute${H===1?"":"s"} ago`;let Q=Math.floor(H/60);if(Q<24)return `${Q} hour${Q===1?"":"s"} ago`;let ne=Math.floor(Q/24);return `${ne} day${ne===1?"":"s"} ago`},{refs:U,context:c}=useFloating({open:o,onOpenChange:y=>{y?b():x();}}),S=useClick(c),T=useRole(c,{role:"dialog"}),{getReferenceProps:E}=useInteractions([S,T]),ge={display:"flex",flexDirection:"column",gap:r[3]},me={fontSize:t.fontSize.base,fontWeight:t.fontWeight.semibold,margin:0,marginTop:"-7px",color:i.foreground,fontFamily:t.fontSans,textAlign:"center"},he={display:"flex",justifyContent:"center",color:i.mutedForeground,fontFamily:t.fontSans,fontSize:t.fontSize.sm},te={display:"flex",flexDirection:"column",gap:r[3]},ye={display:"flex",alignItems:"center",gap:r[2],fontFamily:t.fontSans,fontSize:t.fontSize.sm},be={color:i.success,fontWeight:t.fontWeight.semibold},xe={color:i.success,fontWeight:t.fontWeight.medium},Se={display:"flex",alignItems:"center",gap:r[2],fontSize:t.fontSize.sm,fontFamily:t.fontSans},Ce={color:i.mutedForeground},ve={background:"none",border:"none",color:i.primary,cursor:"pointer",fontSize:t.fontSize.sm,padding:0,textDecoration:"underline",fontFamily:t.fontSans,transition:$.fast},ke={...q.default,backgroundColor:i.secondary,color:i.secondaryForeground,fontWeight:t.fontWeight.normal,padding:`${r[2]} ${r[4]}`,borderRadius:R.lg,border:`1px solid ${i.zinc}`,cursor:"pointer",transition:$.base,width:"100%",fontFamily:t.fontSans,fontSize:t.fontSize.sm,boxShadow:"0 0 12px rgba(255, 255, 255, 0.15)"},we={margin:0,marginTop:"-15px",marginBottom:r[3],padding:`0 ${r[2]}`,color:i.mutedForeground,fontSize:t.fontSize.sm,lineHeight:t.lineHeight.relaxed,fontFamily:t.fontSans,textAlign:"center"},Re={width:"100%",backgroundColor:i.success,color:i.successForeground,fontWeight:t.fontWeight.medium,padding:`${r[3]} ${r[4]}`,borderRadius:R.lg,border:`1px solid ${i.zinc}`,cursor:a?"not-allowed":"pointer",transition:$.base,fontFamily:t.fontSans,fontSize:t.fontSize.sm,display:"flex",alignItems:"center",justifyContent:"center",opacity:a?.7:1,boxShadow:"0 0 12px rgba(255, 255, 255, 0.15)"},Pe={display:"flex",alignItems:"center",gap:r[2]},Te={backgroundColor:`${i.destructive}15`,border:`1px solid ${i.destructive}30`,borderRadius:R.md,padding:`${r[2]} ${r[3]}`,marginTop:r[2],color:i.destructive,fontSize:t.fontSize.sm,fontFamily:t.fontSans,display:s?"block":"none"};return jsxs(Fragment,{children:[jsx("div",{ref:U.setReference,...E(),children:e}),o&&jsx("div",{style:{marginTop:r[3],padding:r[4],borderRadius:R.lg,backgroundColor:i.card,border:`1px solid ${i.border}`},className:d,role:"dialog","aria-labelledby":`kontext-modal-title-${u}`,"aria-describedby":`kontext-modal-description-${u}`,children:jsxs("div",{style:ge,children:[jsx("h2",{id:`kontext-modal-title-${u}`,style:me,children:"Kontext Connection"}),M?jsx("div",{style:he,children:jsx("span",{children:"Loading..."})}):k?jsxs("div",{style:te,children:[jsxs("div",{style:ye,children:[jsx("span",{style:be,children:"\u2713"}),jsx("span",{style:xe,children:"Personalized responses enabled"})]}),l.lastUpdated&&jsxs("div",{style:Se,children:[jsx("span",{style:{fontSize:"1rem",color:l.isStale?i.warning:i.success},children:l.isStale?"\u{1F7E1}":"\u{1F7E2}"}),jsxs("span",{style:Ce,children:["Profile updated ",L(l.lastUpdated)]}),jsx("button",{onClick:()=>l.refresh(),disabled:l.isRefreshing,style:{...ve,color:l.isRefreshing?i.mutedForeground:i.primary,cursor:l.isRefreshing?"not-allowed":"pointer",textDecoration:l.isRefreshing?"none":"underline"},onMouseEnter:y=>{l.isRefreshing||(y.currentTarget.style.opacity="0.8");},onMouseLeave:y=>{y.currentTarget.style.opacity="1";},children:l.isRefreshing?"Refreshing...":"Refresh"})]}),jsx("button",{onClick:K,style:ke,onMouseEnter:y=>{y.currentTarget.style.opacity="0.8";},onMouseLeave:y=>{y.currentTarget.style.opacity="1";},children:"Disconnect"})]}):jsxs("div",{style:te,children:[jsx("p",{id:`kontext-modal-description-${u}`,style:we,children:"Connect your Gmail to enable personalized AI responses based on your communication patterns and preferences."}),jsx("button",{onClick:p,disabled:a,style:Re,onMouseEnter:y=>{a||(y.currentTarget.style.opacity="0.9");},onMouseLeave:y=>{a||(y.currentTarget.style.opacity="1");},children:a?jsxs("span",{style:Pe,children:[jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",style:{animation:"spin 1s linear infinite"},children:jsxs("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"32",strokeDashoffset:"32",children:[jsx("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 32;16 16;0 32;0 32",repeatCount:"indefinite"}),jsx("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-16;-32;-32",repeatCount:"indefinite"})]})}),"Connecting..."]}):"Connect Gmail for Personalization"}),z&&jsx("div",{style:Te,children:z})]})]})}),jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}export{nt as a,O as b,le as c,A as d,W as e,t as f,r as g,R as h,$ as i,N as j,Oe as k,ct as l,lt as m,q as n,dt as o,ut as p,ft as q,We as r,Ge as s,ee as t,je as u};//# sourceMappingURL=chunk-RWDDD5Z4.js.map
//# sourceMappingURL=chunk-RWDDD5Z4.js.map